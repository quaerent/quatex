\usepackage{zref-titleref}
\usepackage{zref-clever}

\zcsetup{cap, noabbrev}

%% Generate a reference box with optional page info
%%   #1 - star (*) for suppressing page info
%%   #2 - target label
%%   #3 - content inside the box
%% TODO: check if the reference is on the same page
\makeatletter
\newcommand{\makerefbox}[3]{%
  \hyperref[#2]{%
    \refbox[right={\IfBooleanTF{#1}{0.15em}{0.1em}}]{%
      #3%
      \IfBooleanF{#1}{%
        \textsuperscript{%
          \ttfamily\tiny\(\,\to\,\)%
          \zref@ifrefundefined{#2}%
            {undefined}%
            {p.\zpageref{#2}}%
        }%
      }%
    }%
  }%
}
\makeatother

%% Enhance the cross-reference commands
\DeclareDocumentCommand{\Cref}{s m}
  {\makerefbox{#1}{#2}{\zcref*[noref]{#2}~\zcref*[noname]{#2}}}
\DeclareDocumentCommand{\Nref}{s m}
  {\makerefbox{#1}{#2}{\ztitleref{#2}}}
